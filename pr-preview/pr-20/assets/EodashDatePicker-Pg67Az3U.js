import{ax as _,ay as E,T as R,az as $,d as M,aA as F,r as D,aB as P,R as j,aC as O,w as Y,aD as N,a5 as C,b as m,a0 as p,a2 as v,aE as y,aF as h,Z as d,a7 as b,t as S,$ as A,M as T,aG as z,V,a4 as g,aH as G,aI as H,aJ as f}from"./index-DGMBu-Jj.js";import{V as J}from"./VTooltip-CEaMI99y.js";import"./VOverlay-C_x6dNdu.js";import"./forwardRefs-DHq7_lF0.js";import"./transition-Dc5JVqAw.js";function L(a,r){const i=typeof a=="string"?_(a):a,e=U(i,r);return{mounted:e,updated:e,unmounted(c){E(null,c)}}}function U(a,r){return function(i,e,c){const u=typeof r=="function"?r(e):r,n=e.value?.text??e.value??u?.text,o=R(e.value)?e.value:{},t=()=>n??i.textContent,s=(c.ctx===e.instance.$?Z(c,e.instance.$)?.provides:c.ctx?.provides)??e.instance.$.provides,l=$(a,M(u,o),t);l.appContext=Object.assign(Object.create(null),e.instance.$.appContext,{provides:s}),E(l,i)}}function Z(a,r){const i=new Set,e=u=>{for(const n of u){if(!n)continue;if(n===a||n.el&&a.el&&n.el===a.el)return!0;i.add(n);let o;if(n.suspense?o=e([n.ssContent]):Array.isArray(n.children)?o=e(n.children):n.component?.vnode&&(o=e([n.component?.subTree])),o)return o;i.delete(n)}return!1};if(!e([r.subTree]))return r;const c=Array.from(i).reverse();for(const u of c)if(u.component)return u.component;return r}const B=L(J,a=>({activator:"parent",location:a.arg?.replace("-"," "),text:typeof a.value=="boolean"?void 0:a.value})),q={class:"d-flex flex-row align-center justify-center pb-1"},K={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px"}},Q=["value"],ne={__name:"EodashDatePicker",props:{hintText:{type:String,default:null},hideArrows:{type:Boolean,default:!1},hideInputField:{type:Boolean,default:!1}},setup(a){const r=F((o,t)=>({get(){return o(),new Date(y.value).getTime()},set(s){t(),h.debug("Datepicker setting currentDate",y.value),y.value=new Date(s).toISOString()}})),i=D({input:"YYYY-MM-DD"}),e=P([]),c=D(null),u=j(O(),"selectedStac");Y(u,async(o,t)=>{if(o&&t?.id!==o.id){h.debug("Datepicker selected STAC change triggered");const s=["#009E73","#0072B2","#E69F00","#CC79A7","#56B4E9","#D55E00"];e.splice(0,e.length);for(let l=0;l<f.length;l++){h.debug("Retrieving dates",f[l]),await f[l].fetchCollection();const x=[...new Set(f[l].getItems()?.reduce((k,I)=>{const w=Date.parse(I.datetime);return w&&k.push(new Date(w)),k},[]))];e.push({key:"id-"+l.toString()+Math.random().toString(16).slice(2),bar:{style:{backgroundColor:s[l%s.length]}},dates:x,content:{style:{color:"#000000","font-weight":"bold"}}})}}},{immediate:!0});function n(o){if(e.length){let t=o?1/0:-1/0;e.forEach(s=>{s?.dates&&s.dates.forEach(l=>{l instanceof Date&&(t=Math[o?"min":"max"](t,l.getTime()))})}),r.value=t===-1/0?Date.now():t===1/0?0:t}}return N(c),(o,t)=>(d(),C("div",{ref_key:"rootRef",ref:c,class:"datePicker"},[m(v(H),{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=s=>r.value=s),modelModifiers:{number:!0},attributes:e,masks:i.value,expanded:"",class:"bg-surface overflow-auto",style:{"background-color":"transparent","max-width":"100%"}},{footer:p(()=>[b("div",q,[a.hideArrows?g("v-if",!0):S((d(),A(V,{key:0,density:"compact",variant:"text",onClick:t[0]||(t[0]=s=>n(!0))},{default:p(()=>[m(T,{icon:[v(z)]},null,8,["icon"])]),_:1})),[[B,"Set date to oldest available dataset","bottom"]]),b("div",K,[a.hideInputField?g("v-if",!0):(d(),C("input",{key:0,value:new Date(r.value).toLocaleDateString(),style:{margin:"1px"},class:"flex-grow px-1 py-1 dark:bg-gray-700"},null,8,Q))]),a.hideArrows?g("v-if",!0):S((d(),A(V,{key:1,density:"compact",variant:"text",onClick:t[1]||(t[1]=s=>n(!1))},{default:p(()=>[m(T,{icon:[v(G)]},null,8,["icon"])]),_:1})),[[B,"Set date to latest available dataset","bottom"]])])]),_:1},8,["modelValue","attributes","masks"])],512))}};export{ne as default};
